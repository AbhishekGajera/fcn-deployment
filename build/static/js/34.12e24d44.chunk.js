(this["webpackJsonppurple-react-free"]=this["webpackJsonppurple-react-free"]||[]).push([[34],{508:function(e,a,t){"use strict";t.r(a);var l=t(7),r=t.n(l),n=t(13),s=t(15),c=t(0),o=t.n(c),i=t(171),d=t(191),u=t.n(d),m=t(60),v=t(51),p=t(10),b=t(210),f=t.n(b),E=t(52),g=t(90),h=t(50);a.default=function(){var e,a,t,l,d=Object(p.g)(),b=Object(i.a)(["user"]),N=Object(s.a)(b,2),O=N[0],j=N[1],y=Object(c.useState)([]),w=Object(s.a)(y,2),_=w[0],S=w[1],D=Object(c.useState)([]),k=Object(s.a)(D,2),x=k[0],C=k[1],L=Object(c.useState)(0),T=Object(s.a)(L,2),B=T[0],q=T[1],G=Object(c.useState)(0),I=Object(s.a)(G,2),J=I[0],P=I[1],R=Object(c.useState)(10),V=Object(s.a)(R,1)[0],A=o.a.useState(!1),F=Object(s.a)(A,2),M=F[0],U=F[1],Y=Object(c.useState)({}),H=Object(s.a)(Y,2),Z=H[0],z=H[1],K=Object(g.a)({mode:"onChange"}),Q=K.register,W=K.handleSubmit,X=K.reset,$=K.formState,ee=$.errors,ae=$.isDirty,te=$.isValid,le=Object(c.useState)("create"),re=Object(s.a)(le,2),ne=re[0],se=re[1],ce=function(){var e=Object(n.a)(r.a.mark((function e(a){var t,l,n,s,c,o;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=new Date(null===a||void 0===a?void 0:a.date_from),l=new Date(null===a||void 0===a?void 0:a.date_to),n=Math.abs(l-t),s=Math.ceil(n/864e5),"edit"!==ne){e.next=19;break}return e.prev=5,c=JSON.stringify({leave_id:null===Z||void 0===Z?void 0:Z.id,user:a.user,reason:null===a||void 0===a?void 0:a.reason,leave_status:null===a||void 0===a?void 0:a.leave_status,total_leave:s,date_from:new Date(null===a||void 0===a?void 0:a.date_from).toISOString(),date_to:new Date(null===a||void 0===a?void 0:a.date_to).toISOString()}),e.next=9,Object(m.o)(c);case 9:v.b.success("Leave updated successfully",{autoClose:!0}),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(5),e.t0&&e.t0.response&&e.t0.response.data&&e.t0.response.data.message?v.b.error(e.t0.response.data.message):v.b.error("There was an internal server error please try again later or contact support@fcn.com");case 15:return e.prev=15,oe(),ue(),e.finish(15);case 19:if("create"!==ne){e.next=34;break}return e.prev=20,o=JSON.stringify({user:a.user,reason:null===a||void 0===a?void 0:a.reason,leave_status:null===a||void 0===a?void 0:a.leave_status,total_leave:s,date_from:new Date(null===a||void 0===a?void 0:a.date_from).toISOString(),date_to:new Date(null===a||void 0===a?void 0:a.date_to).toISOString()}),e.next=24,Object(m.d)(o);case 24:v.b.success("Leave added successfully",{autoClose:!0}),e.next=30;break;case 27:e.prev=27,e.t1=e.catch(20),e.t1&&e.t1.response&&e.t1.response.data&&e.t1.response.data.message?v.b.error(e.t1.response.data.message):v.b.error("There was an internal server error please try again later or contact support@fcn.com");case 30:return e.prev=30,oe(),ue(),e.finish(30);case 34:case"end":return e.stop()}}),e,null,[[5,12,15,19],[20,27,30,34]])})));return function(a){return e.apply(this,arguments)}}(),oe=function(){U(!1),z({}),X()},ie=function(e,a){X(),"edit"===a&&(z(e),se("edit")),"create"===a&&(z(e),se("create")),U(!0)};Object(c.useEffect)((function(){ue()}),[J,V]),Object(c.useEffect)((function(){de()}),[]);var de=function(){var e=Object(n.a)(r.a.mark((function e(){var a;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Object(m.f)();case 3:a=e.sent,C(a.data.results),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),de();case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}(),ue=function(){var e=Object(n.a)(r.a.mark((function e(){var a,t,l,n,s,c;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Object(m.h)(V,J);case 3:return e.next=5,e.sent.data;case 5:a=e.sent,S(null===a||void 0===a?void 0:a.results),q(null===a||void 0===a?void 0:a.totalPages),e.next=14;break;case 10:e.prev=10,e.t0=e.catch(0),(null===e.t0||void 0===e.t0||null===(t=e.t0.response)||void 0===t||null===(l=t.data)||void 0===l?void 0:l.message)?v.b.error(e.t0.response.data.message):v.b.error("There was an internal server error please try again later or contact support@fcn.com"),401===(null===e.t0||void 0===e.t0||null===(n=e.t0.response)||void 0===n||null===(s=n.data)||void 0===s?void 0:s.code)&&(c=JSON.stringify({refreshToken:localStorage.getItem("refreshToken")}),j("user",null,{path:"/"}),Object(m.q)(c).finally((function(){d.push("/user-pages/login-1")})));case 14:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(){return e.apply(this,arguments)}}();return o.a.createElement("div",null,o.a.createElement(E.a,{show:M,onHide:oe,backdrop:"static",keyboard:!1},o.a.createElement(E.a.Header,{closeButton:!0},o.a.createElement(E.a.Title,null,"edit"===ne?"Update":"Create"," Leave")),o.a.createElement(E.a.Body,null,o.a.createElement("div",{className:"row auth"},o.a.createElement("div",{className:"col-12 grid-margin"},o.a.createElement("div",{className:"card"},o.a.createElement("div",{className:"card-body"},o.a.createElement("form",{className:"form-sample",onSubmit:W(ce)},o.a.createElement("div",{className:"row"},o.a.createElement("div",{className:"col-md-12"},o.a.createElement(h.a.Group,{className:"row"},o.a.createElement("label",{className:"col-sm-3 col-form-label"},"User"),o.a.createElement("div",{className:"col-sm-9"},o.a.createElement("select",Object.assign({name:"user"},Q("user"),{defaultValue:null===Z||void 0===Z||null===(e=Z.user)||void 0===e?void 0:e.id}),null===x||void 0===x?void 0:x.map((function(e){var a;return o.a.createElement(o.a.Fragment,null,o.a.createElement("option",{value:null===e||void 0===e?void 0:e.id,selected:(null===Z||void 0===Z||null===(a=Z.user)||void 0===a?void 0:a.id)===(null===e||void 0===e?void 0:e.id)},null===e||void 0===e?void 0:e.name))}))),ee&&ee.user&&o.a.createElement("p",null," select employee is required field"))))),o.a.createElement("div",{className:"row"},o.a.createElement("div",{className:"col-md-12"},o.a.createElement(h.a.Group,{className:"row"},o.a.createElement("label",{className:"col-sm-3 col-form-label"},"Reason"),o.a.createElement("div",{className:"col-sm-9"},o.a.createElement(h.a.Control,Object.assign({type:"text",name:"contactno",defaultValue:null===Z||void 0===Z?void 0:Z.reason,autoFocus:!0},Q("reason",{required:!0}))),ee&&ee.reason&&"required"===ee.reason.type&&o.a.createElement("p",null,"reason is required field"))))),o.a.createElement("div",{className:"row"},o.a.createElement("div",{className:"col-md-12"},o.a.createElement(h.a.Group,{className:"row"},o.a.createElement("label",{className:"col-sm-3 col-form-label"},"Leave Status"),o.a.createElement("div",{className:"col-sm-9"},o.a.createElement("select",Object.assign({name:"leave_status"},Q("leave_status")),o.a.createElement("option",{value:"pending",selected:"pending"===Z.leave_status},"pending"),o.a.createElement("option",{value:"approved",selected:"approved"===Z.leave_status},"approved"),o.a.createElement("option",{value:"rejected",selected:"rejected"===Z.leave_status},"rejected")),ee&&ee.leave_status&&o.a.createElement("p",null,"Leave status is required field"))))),o.a.createElement("div",{className:"row"},o.a.createElement("div",{className:"col-md-12"},o.a.createElement(h.a.Group,{className:"row"},o.a.createElement("label",{className:"col-sm-3 col-form-label"},"Date From"),o.a.createElement("div",{className:"col-sm-9"},o.a.createElement(h.a.Control,Object.assign({type:"date",defaultValue:null===Z||void 0===Z||null===(a=Z.date_from)||void 0===a?void 0:a.substring(0,10),name:"date_from"},Q("date_from",{required:!0}))),ee&&ee.date_from&&o.a.createElement("p",null,"date_from is required field"))))),o.a.createElement("div",{className:"row"},o.a.createElement("div",{className:"col-md-12"},o.a.createElement(h.a.Group,{className:"row"},o.a.createElement("label",{className:"col-sm-3 col-form-label"},"Date To"),o.a.createElement("div",{className:"col-sm-9"},o.a.createElement(h.a.Control,Object.assign({type:"date",defaultValue:null===Z||void 0===Z||null===(t=Z.date_to)||void 0===t?void 0:t.substring(0,10),name:"date_to"},Q("date_to",{required:!0}))),ee&&ee.date_to&&o.a.createElement("p",null,"date_to is required field"))))),o.a.createElement("div",{className:"mt-3"},o.a.createElement("button",{className:"btn  btn-primary btn-lg font-weight-medium auth-form-btn",type:"submit",disabled:!ae||!te},"edit"===ne?"UPDATE":"CREATE"))))))))),o.a.createElement("div",{className:"page-header"},o.a.createElement("h3",{className:"page-title"},"Employee / Leave "),o.a.createElement("nav",{"aria-label":"breadcrumb"},o.a.createElement("ol",{className:"breadcrumb"},o.a.createElement("li",{className:"breadcrumb-item"},o.a.createElement("a",{href:"!#",onClick:function(e){return e.preventDefault()}},null===O||void 0===O||null===(l=O.user)||void 0===l?void 0:l.role," Dashboard")),o.a.createElement("li",{className:"breadcrumb-item active","aria-current":"page"},"Leave Management")))),o.a.createElement("div",{className:"col-lg-12 grid-margin stretch-card p0"},o.a.createElement("div",{className:"card"},o.a.createElement("div",{className:"card-body"},o.a.createElement("h4",{className:"card-title"},"Leave Management"),o.a.createElement("h4",{className:"card-title text-right"},o.a.createElement("button",{type:"button",className:"btn btn-gradient-primary btn-fw",onClick:function(){return ie({},"create")}},"Add New")),o.a.createElement("div",{className:"table-responsive"},o.a.createElement("table",{className:"table table-striped"},o.a.createElement("thead",null,o.a.createElement("tr",null,o.a.createElement("th",null," User "),o.a.createElement("th",null," Reason "),o.a.createElement("th",null," Leave Status "),o.a.createElement("th",null," Total Leave "),o.a.createElement("th",null," Date From "),o.a.createElement("th",null," Date To "),o.a.createElement("th",null," Edit "),o.a.createElement("th",null," Delete "))),o.a.createElement("tbody",null,null===_||void 0===_?void 0:_.map((function(e){var a,t;return o.a.createElement("tr",null,o.a.createElement("td",null,null===e||void 0===e?void 0:e.user.name),o.a.createElement("td",null,null===e||void 0===e?void 0:e.reason),o.a.createElement("td",null,null===e||void 0===e?void 0:e.leave_status),o.a.createElement("td",null,null===e||void 0===e?void 0:e.total_leave),o.a.createElement("td",null,null===(a=new Date(null===e||void 0===e?void 0:e.date_from))||void 0===a?void 0:a.toLocaleDateString("en-GB",{day:"numeric",month:"short",year:"numeric"})),o.a.createElement("td",null,null===(t=new Date(null===e||void 0===e?void 0:e.date_to))||void 0===t?void 0:t.toLocaleDateString("en-GB",{day:"numeric",month:"short",year:"numeric"})),o.a.createElement("td",null,o.a.createElement("i",{onClick:function(){return ie(e,"edit")},className:"mdi mdi-lead-pencil"})),o.a.createElement("td",null,o.a.createElement("i",{onClick:function(){return a=null===e||void 0===e?void 0:e.id,void f.a.fire({title:"Are you sure?",text:"You will not be able to recover this imaginary file!",icon:"warning",showCancelButton:!0,cancelButtonColor:"#DD6B55",confirmButtonColor:"#DD6B55",confirmButtonText:"Yes, delete it!",cancelButtonText:"No, keep it"}).then((function(e){if(e.value)return Object(m.e)(a),f.a.fire("Deleted!","Your imaginary file has been deleted.","success");e.dismiss===f.a.DismissReason.cancel&&f.a.fire("Cancelled","Your imaginary file is safe :)","error")})).finally((function(){ue()}));var a},className:"mdi mdi-delete"}," ")))})))),o.a.createElement(u.a,{breakLabel:"...",nextLabel:"next >",className:"client-list",onPageChange:function(e){var a=e.selected+1;P(a)},forcePage:0,pageRangeDisplayed:5,pageCount:B,previousLabel:"< previous",renderOnZeroPageCount:null}))))))}}}]);
//# sourceMappingURL=34.12e24d44.chunk.js.map